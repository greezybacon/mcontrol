create cotask

    task consumer fork consumer
    task producer fork producer
    task consumer start
    task producer start
    task consumer join

    succeed

    label producer
        let i = 1
        while True; do
            task consumer send i
            let i = i + 1
        done

    label consumer
        debug on
        for x in range(20); do
            let j = [yield]
            print "Got {j}"
        done
        succeed

save

create cotask2

    task consumer fork consumer
    task producer fork producer
    task consumer start
    task producer start

    for x in range(30)
        task consumer send [task producer send]

    succeed

    label producer
        let i = 1
        while True; do
            yield i
            let i = i + i
        done

    label consumer
        while True
            print "Got [yield]"
        succeed

save

run cotask
run cotask2
